<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>실시간 퀴즈</title>

  <!-- 스타일시트 -->
  <link rel="stylesheet" href="app.css" />

  <!-- QR 코드 생성기 (전역 객체 QRCode 등록) -->
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js" defer></script>
</head>
<body>
  <header>
    <h1>실시간 퀴즈</h1>
    <div id="topMenu">
      <input id="roomId" placeholder="클래스(세션) 입력" />
      <button id="btnConnect">접속</button>
      <button id="btnLogout" class="hide">세션아웃</button>
      <span id="roomStatus">세션: - · 오프라인</span>
    </div>
    <nav>
      <button id="tabBuild">① 문항</button>
      <button id="tabOptions">② 옵션</button>
      <button id="tabPresent">③ 프레젠테이션</button>
      <button id="tabResults">④ 결과</button>
    </nav>
  </header>

  <main>
    <!-- 문항 탭 -->
    <section id="panelBuild" class="panel">
      <input id="quizTitle" placeholder="퀴즈 제목" />
      <input id="questionCount" type="number" value="3" />
      <button id="btnBuildForm">빈폼</button>
      <button id="btnLoadSample">샘플</button>
      <button id="btnSaveQuiz">저장</button>
      <button id="btnUpload">업로드</button>
      <button id="btnDownloadSample">샘플양식</button>
      <div id="builder"></div>
      <div class="guide">
        <h3>수동 출제 가이드</h3>
        <p>1. 객관식: 문항, 보기1~4, 정답번호(숫자)</p>
        <p>2. 주관식: 문항, 주관식, 정답텍스트</p>
        <p>3. 예) 가장 큰 행성?, 지구, 목성, 화성, 금성, 2</p>
        <p>4. 문항 옆 <b>이미지 업로드</b>로 그림 포함 가능</p>
      </div>
    </section>

    <!-- 옵션 탭 -->
    <section id="panelOptions" class="panel hide">
      <h3>제출 정책 & 진행</h3>
      <label><input type="radio" name="policy" id="chkDeviceOnce" checked /> 기기당 1회</label>
      <label><input type="radio" name="policy" id="chkNameOnce" /> 실명당 1회</label>
      <label><input type="checkbox" id="chkAccept" /> 제출 허용</label>
      <label><input type="checkbox" id="chkReveal" /> 결과 공개</label>
      <label><input type="checkbox" id="chkBright" /> 프레젠테이션 밝은 모드</label>
      <div>
        <label>타이머(초)</label>
        <input id="timerSec" type="number" value="30" />
      </div>
      <button id="btnOptSave">저장</button>
      <button id="btnResetAll" class="danger">초기화</button>

      <div id="studentAccess">
        <h3>학생용 접속</h3>
        <canvas id="qrCanvas"></canvas>
        <input id="studentLink" readonly />
        <button id="btnCopyLink">복사</button>
        <button id="btnOpenStudent">열기</button>
        <p>※ 옵션 저장 후 QR/링크가 갱신됩니다.</p>
      </div>
    </section>

    <!-- 프레젠테이션 탭 -->
    <section id="panelPresent" class="panel hide">
      <div id="presentControls">
        <button id="btnStart">시작</button>
        <button id="btnPrev">이전</button>
        <button id="btnNext">다음</button>
        <button id="btnEndAll" class="danger">종료</button>
      </div>
      <div id="presentInfo">
        <span id="progress">0/0</span>
        <span id="leftSec">00:00</span>
      </div>
      <div id="pTitle"></div>
      <div id="pQ">시작 버튼을 누르면 문항이 제시됩니다.</div>
      <div id="pOpts"></div>
      <div id="pImg"></div>
      <div id="presentStats">
        <span class="dot blue"></span> 참가
        <span class="dot yellow"></span> 제출
        <span class="dot green"></span> 정답
        <span class="dot red"></span> 오답
      </div>
    </section>

    <!-- 결과 탭 -->
    <section id="panelResults" class="panel hide">
      <button id="btnExportCSV">CSV 내보내기</button>
      <button id="btnLeaderboard">리더보드 전용 화면</button>
      <div id="resultsTable"></div>
    </section>

    <!-- 학생 모드 (별도 뷰) -->
    <section id="studentPanel" class="panel hide">
      <div id="sState">세션 접속 필요</div>
      <input id="studentName" placeholder="이름 또는 번호를 입력하세요!" />
      <button id="btnJoin">참가</button>
      <div id="sQArea" class="hide">
        <div id="badgeType"></div>
        <div id="sQText"></div>
        <div id="sQImg"></div>
        <div id="mcqBox"></div>
        <div id="shortBox" class="hide">
          <input id="shortInput" placeholder="정답 입력" />
          <button id="btnShortSend">제출</button>
        </div>
      </div>
      <div id="myResult" class="hide"></div>
    </section>
  </main>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <!-- 내 JS -->
  <script src="app.js"></script>
</body>
</html>
