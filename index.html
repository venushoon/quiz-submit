<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ì‹¤ì‹œê°„ í€´ì¦ˆ Â· êµë¬´</title>

  <style>
    :root{
      --bg:#0f1623; --panel:#141c2b; --card:#101828; --muted:#94a3b8; --text:#e6edf5;
      --pri:#5b6fff; --ok:#19c37d; --warn:#ffb020; --bad:#ff5d5d; --chip:#1b2540;
      --accent:#7c88ff;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,Malgun Gothic,sans-serif}
    a{color:inherit}
    .wrap{max-width:1200px;margin:0 auto;padding:24px}
    .row{display:flex;gap:12px;align-items:center}
    .col{display:flex;flex-direction:column;gap:12px}
    .panel{background:var(--panel);border:1px solid #1d2740;border-radius:14px;padding:16px}
    .card{background:var(--card);border:1px solid #1b2340;border-radius:12px;padding:14px}
    .grid{display:grid;gap:12px}
    .g2{grid-template-columns:1.2fr .8fr}
    h1{font-size:28px;margin:0 0 8px}
    h2{font-size:18px;margin:0 0 8px;color:#c9d5ff}
    label.small{font-size:12px;color:var(--muted)}
    input,select,textarea{background:#0c1321;border:1px solid #243050;border-radius:10px;color:var(--text);padding:10px 12px;outline:none}
    input:focus,select:focus,textarea:focus{border-color:var(--accent)}
    .btn{border:1px solid #2b3760;background:#111a2f;color:#e6ecff;border-radius:10px;padding:8px 14px;font-weight:600;cursor:pointer}
    .btn:hover{background:#17223a}
    .btn.pri{background:var(--pri);border-color:var(--pri);color:white}
    .btn.ok{background:var(--ok);border-color:var(--ok);color:#04130d}
    .btn.bad{background:#2b0f14;border-color:#531a24;color:#ffd6db}
    .btn.ghost{background:transparent;border-color:#2b385f}
    .tag{background:#1a2240;color:#cfe1ff;border:1px solid #26305a;border-radius:999px;padding:4px 10px;font-size:12px}
    .chip{background:var(--chip);border:1px solid #263661;border-radius:999px;padding:6px 10px;font-size:12px}
    .muted{color:var(--muted)}
    .hidden{display:none!important}
    .table{width:100%;border-collapse:separate;border-spacing:0;overflow:hidden;border-radius:12px;border:1px solid #28345b}
    .table th,.table td{padding:10px 12px;border-bottom:1px solid #22305a;text-align:center}
    .table th{background:#141d31;color:#c8d5ff;font-weight:700}
    .pill{border-radius:999px;padding:2px 8px;font-size:12px;border:1px solid #2a365f;background:#132040}
    .pill.ok{background:#0d2a20;border-color:#234f3d;color:#7fffd1}
    .pill.bad{background:#2a1620;border-color:#5a2c3f;color:#ffd0d0}
    .big{font-size:36px;font-weight:800}
    .qrBox{display:grid;place-items:center;background:#0c1425;border:1px dashed #2a355a;border-radius:12px;height:240px}
    .rightcol{position:sticky;top:12px}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}
    .help{font-size:12px;color:#a9b6d8;line-height:1.55}
    .help h3{margin:14px 0 6px;font-size:12px;color:#cfe1ff;display:flex;gap:6px;align-items:center}
    .help .icon{font-size:12px}
    .kbd{border:1px solid #2b365f;background:#0f1930;border-radius:6px;padding:0 6px;font-size:11px}
    .present{background:#040a18;border:1px solid #2a355a;border-radius:12px;padding:16px}
    .present h2{font-size:22px}
    .option{border:1px solid #2d3a62;background:#0f1730;color:#dae7ff;border-radius:10px;padding:10px 12px;cursor:pointer}
    .option.selected{border-color:#7f8cff;background:#1b2450}
    .option.correct{border-color:#24e39a;box-shadow:0 0 0 2px #24e39a33 inset}
    .option.wrong{border-color:#ff6b6b;box-shadow:0 0 0 2px #ff6b6b33 inset}
  </style>

  <!-- Firebase (ì„ íƒ) -->
  <script defer src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app-compat.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore-compat.js"></script>

  <!-- QR ë¼ì´ë¸ŒëŸ¬ë¦¬ + í´ë°± ê³ ë ¤ -->
  <script defer src="https://unpkg.com/qrcode@1.5.3/build/qrcode.min.js"></script>

  <!-- ì•± ìŠ¤í¬ë¦½íŠ¸ -->
  <script defer src="./app.js"></script>
</head>
<body>
  <div class="wrap">
    <div class="row" style="justify-content:space-between;align-items:flex-end">
      <div>
        <div class="row" style="gap:8px;align-items:center">
          <span class="tag">LIVE</span>
          <span class="muted">ì„¸ì…˜</span>
          <input id="roomIdInput" class="mono" placeholder="ì˜ˆ: classA" style="width:220px" />
          <button id="btnConnect" class="btn pri">ì ‘ì†</button>
          <button id="btnTeacherMode" class="btn">ê´€ë¦¬ì</button>
          <button id="btnStudentMode" class="btn ghost">í•™ìƒ</button>
        </div>
        <h1 style="margin-top:10px">ì‹¤ì‹œê°„ í€´ì¦ˆ</h1>
        <div id="statusText" class="muted">ê´€ë¦¬ì ëª¨ë“œ: ì„¸ì…˜ì„ ì—°ê²°í•´ ì£¼ì„¸ìš”.</div>
      </div>

      <div class="help rightcol" style="max-width:420px">
        <h3><span class="icon">ğŸ“˜</span>ì‚¬ìš© ê°€ì´ë“œ</h3>
        <div id="guide-teacher">
          <p><span class="icon">1ï¸âƒ£</span> ì„¸ì…˜ì½”ë“œë¥¼ ì…ë ¥í•˜ê³  <span class="kbd">ì ‘ì†</span> â†’ <span class="kbd">ë¬¸í•­ ë§Œë“¤ê¸°</span>ì—ì„œ ë¬¸í•­ ì‘ì„± í›„ <span class="kbd">ì €ì¥</span>.</p>
          <p><span class="icon">2ï¸âƒ£</span> <span class="kbd">í”„ë ˆì  í…Œì´ì…˜</span> ì—´ì–´ì„œ í•™ìƒë“¤ê³¼ ê³µìœ . <span class="kbd">ì œì¶œ í—ˆìš©</span>ì„ ì¼œë©´ í•™ìƒ ì œì¶œ ê°€ëŠ¥.</p>
          <p><span class="icon">3ï¸âƒ£</span> <span class="kbd">ê³¨ë“ ë²¨</span>ì„ ì¼œë©´ ì˜¤ë‹µì ìë™ íƒˆë½. ê²°ê³¼ëŠ” <span class="kbd">ê²°ê³¼</span> íƒ­ì—ì„œ í™•ì¸/CSV ì €ì¥.</p>
        </div>
        <div id="guide-student" class="hidden">
          <p><span class="icon">1ï¸âƒ£</span> êµì‚¬ê°€ ì•Œë ¤ì¤€ ì„¸ì…˜ ë§í¬/QRë¡œ ì ‘ì† â†’ ì´ë¦„ ì…ë ¥ í›„ <span class="kbd">ì°¸ê°€</span>.</p>
          <p><span class="icon">2ï¸âƒ£</span> ë¬¸ì œ í™”ë©´ì—ì„œ ë‹µì„ ê³ ë¥´ê³  <span class="kbd">ì œì¶œ</span> ë²„íŠ¼!</p>
          <p><span class="icon">3ï¸âƒ£</span> ê³¨ë“ ë²¨ì´ ì¼œì§„ ê²½ìš° ì˜¤ë‹µ ì‹œ íƒˆë½(í™”ë©´ì— í‘œì‹œ).</p>
        </div>
      </div>
    </div>

    <!-- íƒ­ (ê´€ë¦¬ì) -->
    <div id="teacherPanel" class="panel" style="margin-top:16px">
      <div class="row">
        <button data-tab="build" class="btn pri tab">ë¬¸í•­ ë§Œë“¤ê¸°</button>
        <button data-tab="control" class="btn ghost tab">ì§„í–‰</button>
        <button data-tab="results" class="btn ghost tab">ê²°ê³¼</button>
        <button data-tab="present" class="btn ghost tab">í”„ë ˆì  í…Œì´ì…˜</button>
        <div class="muted" id="policyText" style="margin-left:auto"></div>
      </div>

      <!-- ë¬¸í•­ ë§Œë“¤ê¸° -->
      <section id="tab-build" class="grid g2" style="margin-top:12px">
        <div class="col">
          <div class="card">
            <h2>í€´ì¦ˆ ê¸°ë³¸</h2>
            <div class="row">
              <label class="small">ì œëª©</label>
              <input id="quizTitle" value="ìš°ë¦¬ ë°˜ ì‹¤ì‹œê°„ í€´ì¦ˆ" style="flex:1" />
              <label class="small">ë¬¸í•­ ìˆ˜</label>
              <input id="questionCount" type="number" min="1" max="20" value="3" style="width:90px" />
              <button id="btnBuildForm" class="btn">ë¹ˆ í¼ ë§Œë“¤ê¸°</button>
              <button id="btnLoadSample" class="btn ghost">ìƒ˜í”Œ ë¶ˆëŸ¬ì˜¤ê¸°</button>
            </div>

            <div class="row">
              <label class="small">ì œì¶œ ì •ì±…</label>
              <select id="policySelect">
                <option value="device" selected>ê¸°ê¸°ë‹¹ 1íšŒ</option>
                <option value="name">ì‹¤ëª…ë‹¹ 1íšŒ</option>
              </select>
              <label class="small">ê³¨ë“ ë²¨</label>
              <input id="goldenBellToggle" type="checkbox" />
            </div>
          </div>

          <div id="builder" class="col"></div>

          <div class="row">
            <button id="btnSaveQuiz" class="btn pri">ì €ì¥</button>
            <button id="btnExportJSON" class="btn ghost">JSON ì €ì¥</button>
            <input id="fileImport" type="file" accept="application/json" class="hidden" />
            <button id="btnImportJSON" class="btn ghost">ë¶ˆëŸ¬ì˜¤ê¸°</button>
          </div>
        </div>

        <div class="col">
          <div class="card">
            <h2>í•™ìƒìš© ì ‘ì† QR</h2>
            <div id="qrBox" class="qrBox"></div>
            <div class="row" style="margin-top:8px">
              <label class="small">ë§í¬</label>
              <input id="studentLinkInput" class="mono" style="flex:1" readonly />
              <button id="btnCopy" class="btn">ë§í¬ ë³µì‚¬</button>
              <a id="btnOpenStudent" class="btn ghost" target="_blank">í•™ìƒ ëª¨ë“œë¡œ ì—´ê¸°</a>
            </div>
          </div>
        </div>
      </section>

      <!-- ì§„í–‰ -->
      <section id="tab-control" class="hidden" style="margin-top:12px">
        <div class="grid g2">
          <div class="card col">
            <div class="row" style="flex-wrap:wrap;gap:8px">
              <button id="btnStart" class="btn pri">ì‹œì‘</button>
              <button id="btnPrev" class="btn">ì´ì „</button>
              <button id="btnNext" class="btn">ë‹¤ìŒ</button>
              <label class="row" style="gap:6px"><input id="toggleAccept" type="checkbox" /> ì œì¶œ í—ˆìš©</label>
              <label class="row" style="gap:6px"><input id="toggleReveal" type="checkbox" /> ê²°ê³¼ ê³µê°œ</label>
            </div>

            <div class="row" style="gap:20px;margin-top:6px">
              <div>í˜„ì¬: <span id="ctlTitle" class="pill">-</span></div>
              <div>ë¬¸í•­: <span id="ctlIdx" class="pill">-</span></div>
              <div>ì°¸ê°€: <span id="ctlJoin" class="pill">0</span></div>
            </div>

            <div id="ctlQuestion" class="card" style="min-height:80px"></div>

            <div id="shortGrader" class="card hidden">
              <h2>ì£¼ê´€ì‹ ì±„ì </h2>
              <div id="shortAnswers" class="col"></div>
            </div>
          </div>

          <div class="card">
            <h2>ì§„í–‰ í˜„í™©</h2>
            <div class="row" style="flex-wrap:wrap" id="chips"></div>
            <div class="row" style="gap:8px;margin-top:8px">
              <span class="pill ok">ì •ë‹µ</span>
              <span class="pill bad">ì˜¤ë‹µ</span>
              <span class="pill">ë¯¸ì œì¶œ</span>
              <span class="pill">íƒˆë½</span>
            </div>
          </div>
        </div>
      </section>

      <!-- ê²°ê³¼ -->
      <section id="tab-results" class="hidden" style="margin-top:12px">
        <div class="row" style="gap:8px;margin-bottom:8px">
          <button id="btnExportCSV" class="btn ghost">CSV ë‚´ë³´ë‚´ê¸°</button>
          <button id="btnResetAll" class="btn bad">ì „ì²´ ì´ˆê¸°í™”</button>
        </div>
        <table class="table" id="resultsTable">
          <thead>
            <tr id="resultsHead"></tr>
          </thead>
          <tbody id="resultsBody"></tbody>
        </table>
      </section>

      <!-- í”„ë ˆì  í…Œì´ì…˜ -->
      <section id="tab-present" class="hidden" style="margin-top:12px">
        <div class="present">
          <div class="row" style="justify-content:space-between;align-items:center">
            <h2 id="pptTitle">-</h2>
            <div class="muted" id="pptSub">-</div>
          </div>
          <div id="pptQuestion" style="font-size:22px;margin:12px 0 8px">-</div>
          <div id="pptOptions" class="col"></div>
          <div class="row" style="gap:12px;margin-top:14px">
            <div>ì œì¶œ: <span id="pptSubmit" class="pill">0</span></div>
            <div>ì •ë‹µ: <span id="pptOk" class="pill ok">0</span></div>
            <div>ì˜¤ë‹µ: <span id="pptBad" class="pill bad">0</span></div>
            <div>íƒˆë½: <span id="pptOut" class="pill">0</span></div>
          </div>
        </div>
      </section>
    </div>

    <!-- í•™ìƒ -->
    <div id="joinCard" class="panel hidden" style="margin-top:16px">
      <div class="row" style="gap:10px;align-items:flex-end;flex-wrap:wrap">
        <div class="col" style="min-width:240px">
          <label class="small">ì´ë¦„(ì‹¤ëª…)</label>
          <input id="studentName" placeholder="ì˜ˆ: ê¹€í•˜ëŠ˜" />
        </div>
        <button id="btnJoin" class="btn pri">ì°¸ê°€</button>
        <div id="answerState" class="muted"></div>
      </div>

      <div id="studentQuiz" class="col" style="margin-top:14px">
        <div class="row" style="gap:12px;align-items:center">
          <span id="quizTypeBadge" class="tag">ëŒ€ê¸°</span>
          <span id="questionText" class="big">ëŒ€ê¸° ì¤‘ì…ë‹ˆë‹¤â€¦</span>
          <span id="progressText" class="muted">0 / 0</span>
        </div>
        <div id="optionsContainer" class="col" style="margin-top:10px"></div>
        <div id="subjectiveBox" class="row hidden" style="gap:8px;margin-top:10px">
          <input id="subjectiveInput" placeholder="ì •ë‹µ ì…ë ¥" style="flex:1" />
          <button id="btnSubmitSubjective" class="btn pri">ì œì¶œ</button>
        </div>
        <div class="row" style="gap:8px;margin-top:10px">
          <button id="btnSubmitMCQ" class="btn pri hidden">ì„ íƒ ì œì¶œ</button>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
