:root {
  --bg:#0f1620; --card:#121b26; --muted:#9fb3c8; --text:#e9f0f6;
  --btn:#24364a; --green:#21c07a; --red:#ef5a5a; --chip:#1a2633; --line:#203041;
  --correct-bg: rgba(33, 192, 122, 0.2); --correct-border: #21c07a;
  --incorrect-bg: rgba(239, 90, 90, 0.1);
  --active-border: #4aa8ff;
}
body.bright-mode {
  --bg: #f8f9fa; --card: #ffffff; --muted: #6c757d; --text: #212529;
  --btn: #e9ecef; --green: #28a745; --red: #dc3545; --chip: #e9ecef; --line: #dee2e6;
  --active-border: #0d6efd;
}
*{box-sizing:border-box}
html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:system-ui,Segoe UI,Apple SD Gothic Neo,Roboto,Arial; transition: background-color 0.3s, color 0.3s;}
.hide{display:none !important}
.mt-16{margin-top:16px}

.topbar{background:var(--card); display:flex;align-items:center;gap:16px;padding:16px 20px;border-bottom:1px solid var(--line)}
.brand{margin:0 8px 0 0;font-size:28px}
.session{display:flex;align-items:center;gap:8px}
.status{color:var(--muted);margin-left:8px}

.tabs{display:flex;gap:8px;margin:8px 0 0 20px}
.tab{background:var(--chip);color:var(--text);border:1px solid var(--line);border-radius:12px;padding:10px 16px;cursor:pointer}
.tab.active,.tab:focus{outline:2px solid var(--active-border)}

.panel{max-width:1200px;margin:18px auto;padding:0 20px}
.card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:16px 18px;margin:12px 0}
.row{display:flex;gap:10px;align-items:center}
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
@media (max-width: 900px) { .grid-2 { grid-template-columns: 1fr; } }
.input{background:#0d1420;color:var(--text);border:1px solid var(--line);border-radius:10px;padding:10px 12px}
body.bright-mode .input { background: #f1f3f5; }
.btn,.chip{background:var(--btn);color:var(--text);border:1px solid var(--line);border-radius:12px;padding:10px 14px;cursor:pointer}
.btn.green{background:var(--green);border-color:#198d59;color:#fff}
body.bright-mode .btn.green { color: #fff; }
.btn.danger{background:var(--red);border-color:#b03c3c; color: #fff;}
.chip{background:var(--chip)}
.chipbox{display:flex;gap:8px;}
.muted{color:var(--muted);font-size:14px}

.qtitle{font-size:28px; text-align: center; margin: 20px 0; font-weight: 600;}
#panelPres { display: flex; flex-direction: column; }
.presentation-view { flex-grow: 1; display: flex; flex-direction: column; justify-content: center;}
#pWrap { width: 100%; }
.opts{display:grid; grid-template-columns: 1fr 1fr; max-width: 800px; margin: 20px auto; gap:12px;}
@media (max-width: 600px) { .opts { grid-template-columns: 1fr; } }
.opts .popt,.opts .sopt{background:var(--btn); border: 2px solid transparent; border-radius:14px;padding:24px;font-size:18px;text-align:center;cursor:pointer; transition: all 0.2s ease;}
body.bright-mode .opts .popt, body.bright-mode .opts .sopt { background: #f8f9fa; border: 2px solid #dee2e6;}
.opts .sopt.active { border-color: var(--active-border); background: #1f3147; transform: scale(1.03); font-weight: bold; color: #fff;}
body.bright-mode .opts .sopt.active { background: #cfe2ff; border-color: var(--active-border);}
.opts .correct { background: var(--correct-bg) !important; border-color: var(--correct-border) !important; color: #fff; }
.opts .incorrect { background: var(--incorrect-bg) !important; opacity: 0.6; }
.qimg{max-width:100%; max-height: 400px; object-fit: contain; border-radius:10px; margin:10px auto; display: block;}
#sSubmitBox { text-align: center; }

.qlist .item{display:flex; align-items:center; padding:8px 10px;border:1px solid var(--line);border-radius:10px;margin:6px 0;background:#0d1420}
.qlist .item-text { flex-grow: 1; }
.qlist .delete-btn { background:var(--red); color:white; border:none; border-radius:50%; width:24px; height:24px; cursor:pointer; margin-left:10px; flex-shrink: 0;}
body.bright-mode .qlist .item { background: #f1f3f5; }

.qr{width:240px;height:240px;background:white;border-radius:12px; padding: 10px; box-sizing: content-box; object-fit: contain;}
.table{width:100%;border-collapse:collapse;margin-top:12px}
.table th,.table td{border:1px solid var(--line);padding:10px 12px;text-align:center}

.result-card { text-align: center; }
.result-card .row { justify-content: center; margin-bottom: 1rem;}
.leaderboard tr.rank-1 { background-color: rgba(255, 215, 0, 0.2); }
.leaderboard tr.rank-2 { background-color: rgba(192, 192, 192, 0.2); }
.leaderboard tr.rank-3 { background-color: rgba(205, 127, 50, 0.2); }
.leaderboard tr .rank-icon { font-size: 1.2em; }

dialog { width: 500px; max-width: 90vw; border: 1px solid var(--line); background-color: var(--card); color: var(--text); border-radius: 14px; }
dialog::backdrop { background: rgba(0, 0, 0, 0.7); }

.pres-controls { display: flex; justify-content: space-between; align-items: center; gap: 1rem; flex-wrap: wrap; }
.control-group { display: flex; gap: 0.5rem; }
.timer-display { margin-left: auto; display:flex; gap: 1rem; align-items: center; color: var(--muted); }

#studentPanel .card { color: var(--text); }
#sDone { text-align: center; }
#participantList { list-style-type: none; padding-left: 0; display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 8px; }
#participantList li { background: var(--btn); padding: 6px 10px; border-radius: 8px; text-align: center; font-size: 0.9em; }

.option-card { display: flex; flex-direction: column; gap: 1.5rem; }
.option-group { display: flex; align-items: center; gap: 1rem; flex-wrap: wrap;}
.option-label { font-weight: 600; min-width: 80px; }
.option-controls { display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;}
.option-group .btn { margin-left: auto; }
.guide-text { line-height: 1.8; font-size: 0.9em;}

/* ===== 결과 탭 레이아웃 개선 ===== */

/* 패널 폭(상단 메뉴와 동일, 이미 1200px) 유지하되 카드가 패널을 꽉 채우도록 */
#panelRes .result-card {
  width: 100%;          /* 패널 너비를 가득 채움 */
  max-width: 1200px;    /* 상단 메뉴와 동일 상한 */
  margin: 16px auto;    /* 좌우 중앙 정렬 + 위아래 간격 */
  padding: 24px;
  text-align: left;     /* 제목/버튼 정렬을 좌측 기준으로 */
}

/* 제목과 액션 버튼 정렬 */
#panelRes .result-card h2 {
  margin: 0 0 12px 0;
  font-size: 28px;
  line-height: 1.2;
}

#panelRes .result-card .row {
  justify-content: flex-start;  /* 버튼들을 왼쪽으로 붙임 */
  gap: 12px;
  margin-bottom: 12px;
}

/* 테이블이 카드 폭에 맞춰 안정적으로 채워지도록 */
#panelRes .leaderboard {
  width: 100%;
  table-layout: fixed;  /* 칼럼폭 안정화 */
}

#panelRes .leaderboard th,
#panelRes .leaderboard td {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* 작은 화면에서 표가 넘치면 카드 내부만 가로 스크롤 */
@media (max-width: 900px) {
  #panelRes .result-card {
    overflow-x: auto;
  }
}

/* 카드 시각 균형(상단 메뉴 톤과 맞춤) */
#panelRes .result-card {
  border-radius: 16px;
}

/* ===== 유틸리티 보강 (문항 탭에서 사용 중) ===== */
.grow { flex: 1 1 200px; min-width: 160px; }
.w-120 { width: 120px !important; }
.w-96  { width: 96px  !important; }
.ta-center { text-align: center; }

/* ===== 문항 탭 레이아웃 개선 ===== */
/* 패널 폭(최대 1200px)은 그대로 두고, 카드가 패널을 꽉 채우도록 */
#panelQ .card {
  width: 100%;
  max-width: 1200px;       /* 상단 메뉴와 동일한 상한 */
  margin: 16px auto;       /* 좌우 중앙 + 여백 */
  padding: 24px;           /* 카드 내부 여백 확대 */
  border-radius: 16px;     /* 상단 UI와 톤 맞춤 */
}

/* 상단 입력/버튼 라인: 좌측 정렬 + 랩핑 */
#panelQ .card > .row {
  display: flex;
  flex-wrap: wrap;
  gap: 10px 12px;
  align-items: center;
  justify-content: flex-start;
}

/* 제목 인풋은 넓게, 버튼들은 자연스럽게 따라오게 */
#panelQ #quizTitle {
  min-width: 240px;
}

/* 편집 영역 폼 라인: 넉넉한 간격과 랩핑 */
#panelQ .qedit .row {
  display: flex;
  flex-wrap: wrap;
  gap: 10px 12px;
  align-items: center;
}

/* 문항/타입/정답/파일/추가 버튼 라인에서 select·숫자칸은 고정폭 */
#panelQ #qType { min-width: 120px; }
#panelQ #qAnswer { min-width: 96px; }

/* 보기 입력칸은 균등 배분 */
#panelQ #mcqBox input.input {
  flex: 1 1 200px;
}

/* 보기 줄과 문항 리스트 간격 */
#panelQ #mcqBox { margin-top: 8px; }
#panelQ #qList  { margin-top: 12px; }

/* 문항 리스트 카드는 가독성 개선 */
#panelQ .qlist .item {
  padding: 12px 14px;
  font-size: 15px;
}

/* 작은 화면(태블릿 이하)에서 세로 스택 */
@media (max-width: 900px) {
  #panelQ .card { padding: 20px; }
  #panelQ .qedit .row,
  #panelQ .card > .row { gap: 8px; }
  #panelQ #qType { width: 140px; }
  #panelQ #qAnswer { width: 110px; }
}

@media (max-width: 600px) {
  /* 모바일: 문항/정답 라인도 자연스럽게 떨어지도록 */
  #panelQ #quizTitle { min-width: 180px; }
  #panelQ #qType, #panelQ #qAnswer { width: 48%; }
}

/* 전체화면 모드 스타일 */
body:fullscreen .topbar, body:-webkit-full-screen .topbar { display: none !important; }
body:fullscreen #panelPres, body:-webkit-full-screen #panelPres { height: 100vh; padding: 2rem; margin: 0; max-width: none;}

/* ===== 옵션 탭: 3단 그리드 + 가이드 전체폭 (최종) ===== */

/* 패널 폭을 상단 메뉴와 동일하게 중앙 정렬 */
#panelOpt { max-width: 1200px; margin-inline: auto; }

/* 기본(태블릿 이하): 1열 */
#panelOpt .grid-2 {
  display: grid;
  grid-template-columns: 1fr;
  gap: 16px;
}

/* 큰 화면: 3단 (옵션 | QR | 참가자), 가이드는 2번째 행 전체폭 */
@media (min-width: 1100px) {
  #panelOpt .grid-2 {
    /* 칼럼 비율은 화면에 맞춰 자동으로 늘어나도록 minmax 사용 */
    grid-template-columns:
      minmax(360px, 1.2fr)   /* 옵션 설정 */
      minmax(320px, 1fr)     /* QR */
      minmax(260px, 0.8fr);  /* 참가자 */
    grid-auto-rows: auto;
    align-items: start;
  }

  /* 래퍼(div)들을 평탄화해서 내부 카드가 직접 그리드에 놓이도록 */
  #panelOpt .grid-2 > div { display: contents; }

  /* 1행 배치 지정 */
  #panelOpt .option-card { grid-column: 1; grid-row: 1; }
  #panelOpt #qrCard      { grid-column: 2; grid-row: 1; }
  #panelOpt #participantCard { grid-column: 3; grid-row: 1; }

  /* 가이드는 2행 전체 폭 */
  #panelOpt .grid-2 .card:not(.option-card):not(#qrCard):not(#participantCard) {
    grid-column: 1 / -1;    /* 1~3열 전체 */
    grid-row: 2;
  }
}

/* 카드 톤/여백 통일 */
#panelOpt .card { padding: 24px; border-radius: 16px; }

/* 옵션 카드 내부 여백/간격 */
#panelOpt .option-card h2 { margin: 0 0 14px 0; }
#panelOpt .option-card .option-group { margin-bottom: 14px; }
#panelOpt .option-card .option-controls { gap: 16px; }

/* QR 카드 크기/링크 줄 정돈 */
#panelOpt #qrCard .qr {
  width: 100%;
  max-width: 360px;
  height: auto;
  display: block;
  margin: 8px auto 0;
}
#panelOpt #studentLinkContainer .input { flex: 1 1 auto; min-width: 220px; }

/* 참가자 리스트 스크롤 영역 */
#panelOpt #participantList { max-height: 480px; overflow: auto; padding-right: 4px; }
#panelOpt #participantList li { font-size: 0.95em; }

/* 태블릿(<=900px): 1열로 자연스럽게 접힘 */
@media (max-width: 900px) {
  #panelOpt .grid-2 { grid-template-columns: 1fr; }
  #panelOpt .grid-2 > div { display: block; } /* 평탄화 해제 */
}
